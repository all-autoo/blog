var ke=Object.defineProperty,xe=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var de=(o,r,n)=>r in o?ke(o,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[r]=n,H=(o,r)=>{for(var n in r||(r={}))ze.call(r,n)&&de(o,n,r[n]);if(ue)for(var n of ue(r))Le.call(r,n)&&de(o,n,r[n]);return o},U=(o,r)=>xe(o,Ie(r));import{cb as Ee,bo as Ce,i as B,b as ve,e as le,aj as pe,a as ce,f as me,ch as fe,ci as Oe,cj as Se,$ as ge,u as we,bc as Te,r as w,ck as Ne,cl as $e,g as h,w as oe,U as he,y as ye,o as y,m as re,Q as c,p as z,B as m,t as u,l as t,aG as Ae,H as _,E as O,b3 as Me,k as S,b2 as Ve,ad as Be,a3 as se,cm as De,cn as Re,q as Ye,co as je,cp as Fe,aJ as Xe,ag as He,ah as Pe,n as ie,s as J,aa as Ze,ba as We,_ as _e,cq as D,I as V,bg as qe,v as be,cd as Ge,cr as Ue,a2 as Je,C as Ke,cs as Qe,h as et,ct as tt,cu as at}from"./index.3bdb25d9.js";import{i as nt}from"./position.87c8330b.js";var lt="Expected a function";function ne(o,r,n){var p=!0,T=!0;if(typeof o!="function")throw new TypeError(lt);return Ce(n)&&(p="leading"in n?!!n.leading:p,T="trailing"in n?!!n.trailing:T),Ee(o,r,{leading:p,maxWait:r,trailing:T})}const ot=()=>B&&/firefox/i.test(window.navigator.userAgent),rt=ve({urlList:{type:le(Array),default:()=>pe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),st={close:()=>!0,switch:o=>ce(o)},it=["src"],ct={name:"ElImageViewer"},ut=me(U(H({},ct),{props:rt,emits:st,setup(o,{emit:r}){const n=o,p={CONTAIN:{name:"contain",icon:fe(Oe)},ORIGINAL:{name:"original",icon:fe(Se)}},T=ot()?"DOMMouseScroll":"mousewheel",{t:L}=ge(),s=we("image-viewer"),{nextZIndex:K}=Te(),N=w(),b=w([]),k=Ne(),x=w(!0),d=w(n.initialIndex),v=$e(p.CONTAIN),i=w({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),R=h(()=>{const{urlList:a}=n;return a.length<=1}),$=h(()=>d.value===0),P=h(()=>d.value===n.urlList.length-1),Q=h(()=>n.urlList[d.value]),Y=h(()=>{const{scale:a,deg:e,offsetX:l,offsetY:f,enableTransition:E}=i.value;let g=l/a,C=f/a;switch(e%360){case 90:case-270:[g,C]=[C,-g];break;case 180:case-180:[g,C]=[-g,-C];break;case 270:case-90:[g,C]=[-C,g];break}const M={transform:`scale(${a}) rotate(${e}deg) translate(${g}px, ${C}px)`,transition:E?"transform .3s":""};return v.value.name===p.CONTAIN.name&&(M.maxWidth=M.maxHeight="100%"),M}),ee=h(()=>ce(n.zIndex)?n.zIndex:K());function A(){te(),r("close")}function j(){const a=ne(l=>{switch(l.code){case V.esc:n.closeOnPressEscape&&A();break;case V.space:X();break;case V.left:q();break;case V.up:I("zoomIn");break;case V.right:G();break;case V.down:I("zoomOut");break}}),e=ne(l=>{(l.wheelDelta?l.wheelDelta:-l.detail)>0?I("zoomIn",{zoomRate:1.2,enableTransition:!1}):I("zoomOut",{zoomRate:1.2,enableTransition:!1})});k.run(()=>{D(document,"keydown",a),D(document,T,e)})}function te(){k.stop()}function ae(){x.value=!1}function Z(a){x.value=!1,a.target.alt=L("el.image.error")}function W(a){if(x.value||a.button!==0||!N.value)return;i.value.enableTransition=!1;const{offsetX:e,offsetY:l}=i.value,f=a.pageX,E=a.pageY,g=ne(M=>{i.value=U(H({},i.value),{offsetX:e+M.pageX-f,offsetY:l+M.pageY-E})}),C=D(document,"mousemove",g);D(document,"mouseup",()=>{C()}),a.preventDefault()}function F(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function X(){if(x.value)return;const a=qe(p),e=Object.values(p),l=v.value.name,E=(e.findIndex(g=>g.name===l)+1)%a.length;v.value=p[a[E]],F()}function q(){if($.value&&!n.infinite)return;const a=n.urlList.length;d.value=(d.value-1+a)%a}function G(){if(P.value&&!n.infinite)return;const a=n.urlList.length;d.value=(d.value+1)%a}function I(a,e={}){if(x.value)return;const{zoomRate:l,rotateDeg:f,enableTransition:E}=H({zoomRate:1.4,rotateDeg:90,enableTransition:!0},e);switch(a){case"zoomOut":i.value.scale>.2&&(i.value.scale=Number.parseFloat((i.value.scale/l).toFixed(3)));break;case"zoomIn":i.value.scale<7&&(i.value.scale=Number.parseFloat((i.value.scale*l).toFixed(3)));break;case"clockwise":i.value.deg+=f;break;case"anticlockwise":i.value.deg-=f;break}i.value.enableTransition=E}return oe(Q,()=>{he(()=>{const a=b.value[0];a!=null&&a.complete||(x.value=!0)})}),oe(d,a=>{F(),r("switch",a)}),ye(()=>{var a,e;j(),(e=(a=N.value)==null?void 0:a.focus)==null||e.call(a)}),(a,e)=>(y(),re(We,{to:"body",disabled:!a.teleported},[c(Ze,{name:"viewer-fade",appear:""},{default:z(()=>[m("div",{ref_key:"wrapper",ref:N,tabindex:-1,class:u(t(s).e("wrapper")),style:ie({zIndex:t(ee)})},[m("div",{class:u(t(s).e("mask")),onClick:e[0]||(e[0]=Ae(l=>a.hideOnClickModal&&A(),["self"]))},null,2),_(" CLOSE "),m("span",{class:u([t(s).e("btn"),t(s).e("close")]),onClick:A},[c(t(O),null,{default:z(()=>[c(t(Me))]),_:1})],2),_(" ARROW "),t(R)?_("v-if",!0):(y(),S(se,{key:0},[m("span",{class:u([t(s).e("btn"),t(s).e("prev"),t(s).is("disabled",!a.infinite&&t($))]),onClick:q},[c(t(O),null,{default:z(()=>[c(t(Ve))]),_:1})],2),m("span",{class:u([t(s).e("btn"),t(s).e("next"),t(s).is("disabled",!a.infinite&&t(P))]),onClick:G},[c(t(O),null,{default:z(()=>[c(t(Be))]),_:1})],2)],64)),_(" ACTIONS "),m("div",{class:u([t(s).e("btn"),t(s).e("actions")])},[m("div",{class:u(t(s).e("actions__inner"))},[c(t(O),{onClick:e[1]||(e[1]=l=>I("zoomOut"))},{default:z(()=>[c(t(De))]),_:1}),c(t(O),{onClick:e[2]||(e[2]=l=>I("zoomIn"))},{default:z(()=>[c(t(Re))]),_:1}),m("i",{class:u(t(s).e("actions__divider"))},null,2),c(t(O),{onClick:X},{default:z(()=>[(y(),re(Ye(t(v).icon)))]),_:1}),m("i",{class:u(t(s).e("actions__divider"))},null,2),c(t(O),{onClick:e[3]||(e[3]=l=>I("anticlockwise"))},{default:z(()=>[c(t(je))]),_:1}),c(t(O),{onClick:e[4]||(e[4]=l=>I("clockwise"))},{default:z(()=>[c(t(Fe))]),_:1})],2)],2),_(" CANVAS "),m("div",{class:u(t(s).e("canvas"))},[(y(!0),S(se,null,Xe(a.urlList,(l,f)=>He((y(),S("img",{ref_for:!0,ref:E=>b.value[f]=E,key:l,src:l,style:ie(t(Y)),class:u(t(s).e("img")),onLoad:ae,onError:Z,onMousedown:W},null,46,it)),[[Pe,f===d.value]])),128))],2),J(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}}));var dt=_e(ut,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const ft=be(dt),vt=ve({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:le([String,Object])},previewSrcList:{type:le(Array),default:()=>pe([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),pt={load:o=>o instanceof Event,error:o=>o instanceof Event,switch:o=>ce(o),close:()=>!0},mt=["src","loading"],gt={key:0},wt={name:"ElImage",inheritAttrs:!1},ht=me(U(H({},wt),{props:vt,emits:pt,setup(o,{emit:r}){const n=o;let p="";const{t:T}=ge(),L=we("image"),s=Ge(),K=Ue(),N=w(),b=w(!1),k=w(!0),x=w(!1),d=w(),v=w(),i=B&&"loading"in HTMLImageElement.prototype;let R,$;const P=h(()=>s.style),Q=h(()=>{const{fit:e}=n;return B&&e?{objectFit:e}:{}}),Y=h(()=>{const{previewSrcList:e}=n;return Array.isArray(e)&&e.length>0}),ee=h(()=>{const{previewSrcList:e,initialIndex:l}=n;let f=l;return l>e.length-1&&(f=0),f}),A=h(()=>n.loading==="eager"?!1:!i&&n.loading==="lazy"||n.lazy),j=()=>{!B||(k.value=!0,b.value=!1,N.value=n.src)};function te(e){k.value=!1,b.value=!1,r("load",e)}function ae(e){k.value=!1,b.value=!0,r("error",e)}function Z(){nt(d.value,v.value)&&(j(),X())}const W=at(Z,200);async function F(){var e;if(!B)return;await he();const{scrollContainer:l}=n;Qe(l)?v.value=l:et(l)&&l!==""?v.value=(e=document.querySelector(l))!=null?e:void 0:d.value&&(v.value=tt(d.value)),v.value&&(R=D(v,"scroll",W),setTimeout(()=>Z(),100))}function X(){!B||!v.value||!W||(R==null||R(),v.value=void 0)}function q(e){if(!!e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function G(){!Y.value||($=D("wheel",q,{passive:!1}),p=document.body.style.overflow,document.body.style.overflow="hidden",x.value=!0)}function I(){$==null||$(),document.body.style.overflow=p,x.value=!1,r("close")}function a(e){r("switch",e)}return oe(()=>n.src,()=>{A.value?(k.value=!0,b.value=!1,X(),F()):j()}),ye(()=>{A.value?F():j()}),(e,l)=>(y(),S("div",{ref_key:"container",ref:d,class:u([t(L).b(),e.$attrs.class]),style:ie(t(P))},[N.value!==void 0&&!b.value?(y(),S("img",Je({key:0},t(K),{src:N.value,loading:e.loading,style:t(Q),class:[t(L).e("inner"),t(Y)&&t(L).e("preview"),k.value&&t(L).is("loading")],onClick:G,onLoad:te,onError:ae}),null,16,mt)):_("v-if",!0),k.value||b.value?(y(),S("div",{key:1,class:u(t(L).e("wrapper"))},[k.value?J(e.$slots,"placeholder",{key:0},()=>[m("div",{class:u(t(L).e("placeholder"))},null,2)]):b.value?J(e.$slots,"error",{key:1},()=>[m("div",{class:u(t(L).e("error"))},Ke(t(T)("el.image.error")),3)]):_("v-if",!0)],2)):_("v-if",!0),t(Y)?(y(),S(se,{key:2},[x.value?(y(),re(t(ft),{key:0,"z-index":e.zIndex,"initial-index":t(ee),infinite:e.infinite,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:I,onSwitch:a},{default:z(()=>[e.$slots.viewer?(y(),S("div",gt,[J(e.$slots,"viewer")])):_("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):_("v-if",!0)],64)):_("v-if",!0)],6))}}));var yt=_e(ht,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const xt=be(yt);export{xt as E};
