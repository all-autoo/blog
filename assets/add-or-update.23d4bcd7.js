import{f as K,r as u,ae as L,o as E,m as b,p as s,Q as l,B as R,H as U,aE as w,an as C,d3 as T,aV as H,bn as M,cP as O,V as $}from"./index.3bdb25d9.js";import{E as q}from"./dialog.e3a021d0.js";import"./overlay.8739d102.js";/* empty css               */import{E as P,a as S}from"./form-item.9838b7ac.js";import{E as j}from"./tree.3652bf65.js";import{a as Q,b as z}from"./role.a39e6ffc.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";import"./index.5a7c4eec.js";const J={class:"form-tree"},W=C("\u53D6\u6D88"),X=C("\u786E\u5B9A"),Y=K({__name:"add-or-update",emits:["refreshDataList"],setup(Z,{expose:V,emit:h}){const n=u(!1),d=u([]),f=u([]),r=u(),i=u(),c=u(!1),o=L({id:"",roleName:"",permissionIds:[],remark:""}),y=a=>{n.value=!0,o.id="",i.value&&i.value.resetFields(),r.value&&r.value.setCheckedKeys([]),a&&F(a),g()},_=()=>{d.value.forEach(a=>{a.permissionName==="\u7CFB\u7EDF\u9996\u9875"&&(a.disabled=!0,f.value=[a.id])})},g=()=>{T().then(a=>{d.value=a.data,_()})},F=a=>{Q(a).then(e=>{Object.assign(o,e.data),o.permissionIds.forEach(m=>r.value.setChecked(m,!0))})},x=u({roleName:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),D=a=>{r.value.setCheckedKeys(a?d.value.map(e=>e.id):[]),_()},v=()=>{i.value.validate(a=>{if(!a)return!1;o.id||(o.permissionIds=[...r.value.getCheckedKeys()]),z(o).then(()=>{H.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{n.value=!1,h("refreshDataList")}})})})};return V({init:y}),(a,e)=>{const m=M,p=P,N=O,B=j,A=S,k=$,I=q;return E(),b(I,{modelValue:n.value,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value=t),title:o.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:s(()=>[l(k,{onClick:e[4]||(e[4]=t=>n.value=!1)},{default:s(()=>[W]),_:1}),l(k,{type:"primary",onClick:e[5]||(e[5]=t=>v())},{default:s(()=>[X]),_:1})]),default:s(()=>[l(A,{ref_key:"dataFormRef",ref:i,model:o,rules:x.value,"label-width":"120px",onKeyup:e[3]||(e[3]=w(t=>v(),["enter"]))},{default:s(()=>[l(p,{prop:"roleName",label:"\u540D\u79F0"},{default:s(()=>[l(m,{modelValue:o.roleName,"onUpdate:modelValue":e[0]||(e[0]=t=>o.roleName=t),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(p,{prop:"remark",label:"\u5907\u6CE8"},{default:s(()=>[l(m,{modelValue:o.remark,"onUpdate:modelValue":e[1]||(e[1]=t=>o.remark=t),placeholder:"\u5907\u6CE8"},null,8,["modelValue"])]),_:1}),o.id?U("",!0):(E(),b(p,{key:0,label:"\u83DC\u5355\u6743\u9650"},{default:s(()=>[l(N,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=t=>c.value=t),label:"\u5168\u9009/\u5168\u4E0D\u9009",onChange:D},null,8,["modelValue"]),R("div",J,[l(B,{ref_key:"menuListTree",ref:r,data:d.value,"default-checked-keys":f.value,props:{label:"permissionName",children:"childs"},"node-key":"id",accordion:"","show-checkbox":""},null,8,["data","default-checked-keys"])])]),_:1}))]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});var de=G(Y,[["__scopeId","data-v-fa411664"]]);export{de as default};
