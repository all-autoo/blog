import{f as V,r as l,ae as B,o as K,m as N,p as n,P as r,B as I,aN as L,an as v,bm as w,cF as R,U as T}from"./index.a7d776d7.js";import{E as U}from"./overlay.cbad9685.js";/* empty css               */import{E as H,a as P}from"./form-item.2e6d27d6.js";import{E as $}from"./tree.1e55cf66.js";import{q,d as A}from"./role.37267f67.js";import{_ as M}from"./plugin-vue_export-helper.21dcd24c.js";import"./refs.24712170.js";import"./index.0ebdec77.js";const S={class:"form-tree"},j=v("\u53D6\u6D88"),z=v("\u786E\u5B9A"),G=V({__name:"role",emits:["refreshDataList"],setup(J,{expose:k,emit:h}){const u=l(!1),d=l([]),m=l([]),t=l(),i=l(),c=l(!1),a=B({id:"",permissionIds:[]}),y=o=>{u.value=!0,a.id=o||"",i.value&&i.value.resetFields(),t.value&&t.value.setCheckedKeys([]),o&&E(o)},f=()=>{d.value.forEach(o=>{o.permissionName==="\u7CFB\u7EDF\u9996\u9875"&&(o.disabled=!0,m.value=[o.id])})},E=o=>{q({roleId:o}).then(e=>{a.permissionIds=e.data.selectNode,d.value=e.data.tree,f(),m.value=e.data.selectNode})},C=o=>{t.value.setCheckedKeys(o?d.value.map(e=>e.id):[]),f()},p=()=>{i.value.validate(o=>{if(!o)return!1;console.log(t.value.getHalfCheckedKeys(),t.value.getCheckedKeys()),a.permissionIds=[...t.value.getCheckedKeys()],A(a).then(()=>{w.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{u.value=!1,h("refreshDataList")}})})})};return k({init:y}),(o,e)=>{const b=R,g=$,x=H,F=P,_=T,D=U;return K(),N(D,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=s=>u.value=s),title:a.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:n(()=>[r(_,{onClick:e[2]||(e[2]=s=>u.value=!1)},{default:n(()=>[j]),_:1}),r(_,{type:"primary",onClick:e[3]||(e[3]=s=>p())},{default:n(()=>[z]),_:1})]),default:n(()=>[r(F,{ref_key:"dataFormRef",ref:i,model:a,"label-width":"120px",onKeyup:e[1]||(e[1]=L(s=>p(),["enter"]))},{default:n(()=>[r(x,{label:"\u83DC\u5355\u6743\u9650"},{default:n(()=>[r(b,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),label:"\u5168\u9009/\u5168\u4E0D\u9009",onChange:C},null,8,["modelValue"]),I("div",S,[r(g,{ref_key:"menuListTree",ref:t,data:d.value,"default-checked-keys":m.value,props:{label:"permissionName",children:"childs"},"node-key":"id",accordion:"","show-checkbox":""},null,8,["data","default-checked-keys"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}});var ae=M(G,[["__scopeId","data-v-fddec30a"]]);export{ae as default};
